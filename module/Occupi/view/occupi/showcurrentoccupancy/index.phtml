<?php

$this->headTitle('Occupi / Show Currency Occupancy');

$this->mainMenu()->setActiveItemId('occupi/showcurrentoccupancy');

$this->pageBreadcrumbs()->setItems([
    'Home'=>$this->url('home'),
    'Occupi'=>$this->url('occupi'),
    'Show Currency Occupancy'=>$this->url('occupi/showcurrentoccupancy'),
]);

?>

<h1 id="occupi_header_name">Show Currency Occupancy</h1>

<script>

   // jQuery(document).ready(function($){


        var i = setInterval(function(){
            $.ajax({
                type: "GET",
                url : "http://occupi.yottatrend.com/occupi/showcurrentoccupancy/getRealTimeData",
                //data : $("#mvl_main_new_user_login_form_data").serialize(),
                success: function(response){
                    $('#occupi_test').html(response);
                   // for (var i = 0; i < response.length; i++) {
                        // response[i] can be used to get each value
                      //  var sensor_data = JSON.parse(response[i]['sensor_data']);

                   // }
                    var sensor_data = response[0]['jsondata'];
                    $('#sensor_data').html(sensor_data);
                    var sensor_id = response[0];
                    $('#sensor_id').html(sensor_data);
                }
            });
        },1000);



    //});
</script>


<div id="occupi_test"></div>
<div id="sensor_data"></div>
<div id="sensor_id"></div>
<?php
    function heatmapcolorcssconverter($temp){
    $temp_buf = (int)number_format($temp,2);
    $temp_hsl = 200-(($temp_buf*5)+5);
    if ($temp_hsl <= 0){
    $temp_hsl = '0';
    }
    echo 'background-color: hsl('.$temp_hsl.', 50%, 50%);';
    return;
    }

    foreach ($rows as $row){

    $jsondata = json_decode($row['jsondata']);
    //print_r($row);
    ?>
    <div style="width: 400px;display: inline-block;margin-left: auto;margin-right: auto;">
        <div>Last Update : <?php echo $row['lastupdate']?></div>
        <div>Device Mac Address : <?php echo $row['mac_address']?></div>
        <div>Device Timestamp : <?php echo $jsondata->timestamp?></div>
        <div>CPU Temp. : <?php echo $jsondata->CPU_Temp?></div>
        <div>GPU Temp. : <?php echo $jsondata->GPU_Temp?></div>
        <div>Occupancy Counter : <?php print_r($rows_cnt['0']['occupancy_counter'])?></div>
        <div>Sensor Data : <?php //echo $jsondata->sensor_data?></div>
        <div>
            <?php
            $sensordata_array = json_decode($jsondata->sensor_data);
            // print_r($sensordata_array);

            ?>
            <table style="margin-top: 5px;padding: 5px;text-align: center;font-size: 16px;margin-left: auto;margin-right: auto;">
                <tr style="padding: 5px">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['63']);?>"><?php echo number_format($sensordata_array['63'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['62']);?>"><?php echo number_format($sensordata_array['62'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['61']);?>"><?php echo number_format($sensordata_array['61'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['60']);?>"><?php echo number_format($sensordata_array['60'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['59']);?>"><?php echo number_format($sensordata_array['59'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['58']);?>"><?php echo number_format($sensordata_array['58'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['57']);?>"><?php echo number_format($sensordata_array['57'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['56']);?>"><?php echo number_format($sensordata_array['56'],2);;?></td>
                </tr>
                <tr style="padding: 5px">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['55']);?>"><?php echo number_format($sensordata_array['55'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['54']);?>"><?php echo number_format($sensordata_array['54'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['53']);?>"><?php echo number_format($sensordata_array['53'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['52']);?>"><?php echo number_format($sensordata_array['52'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['51']);?>"><?php echo number_format($sensordata_array['51'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['50']);?>"><?php echo number_format($sensordata_array['50'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['49']);?>"><?php echo number_format($sensordata_array['49'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['48']);?>"><?php echo number_format($sensordata_array['48'],2);;?></td>
                </tr>
                <tr style="padding: 5px">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['47']);?>"><?php echo number_format($sensordata_array['47'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['46']);?>"><?php echo number_format($sensordata_array['46'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['45']);?>"><?php echo number_format($sensordata_array['45'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['44']);?>"><?php echo number_format($sensordata_array['44'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['43']);?>"><?php echo number_format($sensordata_array['43'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['42']);?>"><?php echo number_format($sensordata_array['42'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['41']);?>"><?php echo number_format($sensordata_array['41'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['40']);?>"><?php echo number_format($sensordata_array['40'],2);;?></td>
                </tr>
                <tr style="padding: 5px">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['39']);?>"><?php echo number_format($sensordata_array['39'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['38']);?>"><?php echo number_format($sensordata_array['38'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['37']);?>"><?php echo number_format($sensordata_array['37'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['36']);?>"><?php echo number_format($sensordata_array['36'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['35']);?>"><?php echo number_format($sensordata_array['35'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['34']);?>"><?php echo number_format($sensordata_array['34'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['33']);?>"><?php echo number_format($sensordata_array['33'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['32']);?>"><?php echo number_format($sensordata_array['32'],2);;?></td>
                </tr>
                <tr style="padding: 5px">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['31']);?>;"><?php echo number_format($sensordata_array['31'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['30']);?>;"><?php echo number_format($sensordata_array['30'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['29']);?>;"><?php echo number_format($sensordata_array['29'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['28']);?>;"><?php echo number_format($sensordata_array['28'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['27']);?>;"><?php echo number_format($sensordata_array['27'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['26']);?>;"><?php echo number_format($sensordata_array['26'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['25']);?>;"><?php echo number_format($sensordata_array['25'],2);;?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['24']);?>;"><?php echo number_format($sensordata_array['24'],2);;?></td>
                </tr>
                <tr style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['63']);?>;">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['23']);?>;"><?php echo number_format($sensordata_array['23'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['22']);?>;"><?php echo number_format($sensordata_array['22'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['21']);?>;"><?php echo number_format($sensordata_array['21'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['20']);?>;"><?php echo number_format($sensordata_array['20'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['19']);?>;"><?php echo number_format($sensordata_array['19'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['18']);?>;"><?php echo number_format($sensordata_array['18'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['17']);?>;"><?php echo number_format($sensordata_array['17'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['16']);?>;"><?php echo number_format($sensordata_array['16'],2);?></td>
                </tr>

                <tr style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['63']);?>;">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['15']);?>;"><?php echo number_format($sensordata_array['15'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['14']);?>;"><?php echo number_format($sensordata_array['14'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['13']);?>;"><?php echo number_format($sensordata_array['13'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['12']);?>;"><?php echo number_format($sensordata_array['12'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['11']);?>;"><?php echo number_format($sensordata_array['11'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['10']);?>;"><?php echo number_format($sensordata_array['10'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['9']);?>;"><?php echo number_format($sensordata_array['9'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['8']);?>;"><?php echo number_format($sensordata_array['8'],2);?></td>
                </tr>
                <tr style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['63']);?>;">
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['7']);?>;"><?php echo number_format($sensordata_array['7'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['6']);?>;"><?php echo number_format($sensordata_array['6'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['5']);?>;"><?php echo number_format($sensordata_array['5'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['4']);?>;"><?php echo number_format($sensordata_array['4'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['3']);?>;"><?php echo number_format($sensordata_array['3'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['2']);?>;"><?php echo number_format($sensordata_array['2'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['1']);?>;"><?php echo number_format($sensordata_array['1'],2);?></td>
                    <td style="padding: 5px;<?php heatmapcolorcssconverter($sensordata_array['0']);?>;"><?php echo number_format($sensordata_array['0'],2);?></td>
                </tr>
            </table>


        </div>
    </div>
<?php
}
?>



